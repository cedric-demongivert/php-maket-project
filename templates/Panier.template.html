{% include 'header.template.html' %}

<table id='mainBlock'>
	<tr>
		<td id="leftBlock">
		
			{% include 'menu.template.html' %}
		
		</td>
		<td id='rightBlock'>
		
			{% if panier.articles|length > 0 %}
				<table class='dataTable'>
				
					<tr>
						<th>
							Produit(s)
						</th>
						<th>
							
						</th>
						<th>
							Prix unitaire
						</th>
						<th>
							Quantit&eacute;e
						</th>
						<th>
							Prix total
						</th>
						<th>
							Op&eacute;rations
						</th>
					</tr>
					{% set total = 0 %}
					{% for panieritem in panier.articles %}
					
						<tr>
							<td>
								<img width="150px" src="img/{{ panieritem.image }}" />
							</td>
							<td>
								{{ panieritem.nom|escape }}
								{% if panieritem.remise > 0 %}
									<br/><span class="remise_label">- {{ panieritem.remise }} % !</span>
								{% endif %}
							</td>
							<td>
								{{ panieritem.prix*(1 - panieritem.remise/100.0) }}
								{% set prix = panieritem.prix*(1 - panieritem.remise/100.0) %}
								{% if panieritem.remise > 0 %}
								<br/><span class="remise_prix">- {{ panieritem.prix*(panieritem.remise/100.0) }} </span>
								{% endif %}
							</td>
							<td>
								{{ panieritem.nombre }}
							</td>
							<td>
								{% set total = total + (panieritem.nombre * prix) %}
								{{ panieritem.nombre * prix }}
							</td>
							<td>
								<form action="index.php?service=PanierController&function=addQuantity&id_article={{ panieritem.id }}" method="POST">
									 <input style="width:180px;" type="text" name="nombre" placeholder="Entier n&eacute;gatif pour retirer"/> <input type="SUBMIT" value="Ajouter"/>
								</form>
								<a href='index.php?service=PanierController&function=remove&id_article={{ panieritem.id }}'>+Supprimer</a>
							</td>
						</tr>
					{% endfor %}
				</table>
				{% if app.request.get('modif') == 1 %}
				
					<table class='dataTable'>
						<tr>
							<th>Un ou plusieurs des produits de votre panier n'est pas disponible dans les 
								quantit&eacute; indiqu&eacute;. Voulez-vous les supprimmer ? 
							</th>
							<td>
								<form action="index.php?service=PanierController&function=modif">
									<input type="SUBMIT" value="Valider"/>
								</form>
								<form action="index.php?service=PanierController">
									<input type="SUBMIT" value="Refuser"/>
								</form>
							</td>
						</tr>
					</table>
				
				{% endif %}
				<table class='dataTable'>
					<tr>
						<th>
							Prix total de la commande : 
						</th>
						<td>
							{{ total }}
						</td>
						<td>
							<form method="post" action="index.php?service=PanierController&function=validate">
								<input type="SUBMIT" value="Valider la commande"/>
							</form>
						</td>
					</tr>
				</table>
			{% endif %}
			
		</td>
	</tr>
</table>

{% include 'footer.template.html' %}